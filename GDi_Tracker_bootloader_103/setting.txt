

Собственно, данные для обмена с "загрузчиком".

typedef struct
{
    u32 start_addr;    // адрес начала программы(таблица векторов прерываний)
    u32 file_len;          // размер программы в байтах
    u32 crc;                 // crc32 для файла
} sFirmwareFile;

typedef struct
{
    sFirmwareFile file0;
    sFirmwareFile file1;
    u32 file_num_to_run;    // номер программы для запуска 0 - file0, 1 - file1
    u32 crc;                            // crc32 для вышеперечисленных полей
    u16 crc_wrong_flag;       // флаг неверной crc для указанного номера программы: 0 - если событие имело место
} sLoaderRec;

    Для расчета crc32 используем аппаратный модуль МК. Поскольку модуль принимает 32х разрядные значения - следует производить выравнивание длины файла до 4байт.
    Запись типа sLoaderRec располагаем в начале последней страницы памяти МК. Можно продублировать(рядом записать еще одну копию).
    Следует обратить внимание на сборку кода линкером: если программа собранная с начальным адресом, к примеру, 0x1000 будет записана на другой физический адрес, например, 0x20000 - работоспособность у нее будет нулевой. 
	Благодаря привязке инструкций переходов к абсолютным адресам. 